<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ’¼ A Study in Budgets ðŸ’¼</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=Newsreader:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Hero -->
    <section class="hero">
        <div class="hero-content">
            <p class="hero-quote">"The world does not owe us a living."</p>
            <p class="hero-attribution">â€” Finance Minister Lim Kim San, 1966</p>
            <div class="hero-spacer"></div>
            <p class="hero-quote">"We will always have your backs."</p>
            <p class="hero-attribution">â€” Finance Minister Lawrence Wong, 2024</p>
            <div class="hero-spacer"></div>
            <p class="hero-question">What changed?</by></p>
            <div class="scroll-prompt">
                <span>Scroll to explore</span>
                <div class="scroll-arrow"></div>
            </div>
        </div>
    </section>

    <!-- Scrollytelling -->
    <div class="scrolly-container">
        <div class="sticky-viz">
            <div class="viz-header">
                <h2 class="current-era">Turns out, a lot has.</h2>
                <p class="current-context">We dissect 67 Singapore Budget Statements delivered over the past 61 years to find out how the social compact has shifted.</p>
            </div>
            <!-- Mobile legend - diverging chart -->
            <div class="mobile-legend">
                <div class="mobile-legend-group">
                    <span class="legend-arrow" style="color:#C44F4F">â†‘</span>
                    <div class="mobile-legend-item"><span class="dot" style="background:#C44F4F"></span>Promises to you</div>
                    <div class="mobile-legend-item"><span class="dot" style="background:#E89898"></span>Promises to firms</div>
                </div>
                <div class="mobile-legend-group">
                    <span class="legend-arrow" style="color:#2B4460">â†“</span>
                    <div class="mobile-legend-item"><span class="dot" style="background:#2B4460"></span>Asks of you</div>
                    <div class="mobile-legend-item"><span class="dot" style="background:#6B8CAE"></span>Asks of firms</div>
                </div>
            </div>
            <div id="timeline-viz"></div>
            <!-- Legend temporarily removed for debugging -->
            <div class="year-progress">
                <div class="progress-bar"><div class="progress-fill"></div></div>
            </div>
        </div>

        <div class="scroll-sections" id="scroll-sections">
            <!-- Generated by JS from curated_story.json -->
        </div>

        <!-- Spacer to maintain scroll height for sticky chart transition -->
        <div class="scroll-spacer"></div>
    </div>

    <!-- Fixed methodology link -->
    <a href="https://github.com/wongpeiting/study_in_budgets" target="_blank" class="methodology-link">
        Data & methodology
    </a>

    <!-- Mobile back button - only visible in interactive mode on mobile -->
    <button class="mobile-back-btn" onclick="exitInteractiveModeAndScrollTop()">
        â†‘ Back to top
    </button>

    <!-- Hover Panel for quote display -->
    <div id="hover-panel" class="hover-panel hidden">
        <button class="hover-panel-close" onclick="unpinQuote()">&times;</button>
        <div class="hover-panel-header">
            <span class="hover-panel-year"></span>
            <span class="hover-panel-fm"></span>
        </div>
        <blockquote class="hover-panel-quote"></blockquote>
        <div class="hover-panel-tag"></div>
        <div class="hover-panel-hint">Click on a square to pin this quote</div>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
